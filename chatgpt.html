<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Chat with OpenAI</title>
    <link rel="stylesheet" type="text/css" href="styles.css" />
  </head>
  <body>
    <div id="chatbox" class="chatbox"></div>
    <form id="message-form" class="message-form">
      <input
        type="text"
        name="message"
        placeholder="Type your message here"
        required
      />
      <button type="submit">Send</button>
    </form>
    <script src="https://cdn.jsdelivr.net/npm/@openai/api@0.7.2/build/web-bundle.min.js"></script>
    <script>
      // 初始化OpenAI API
      const api = new OpenAI({
        apiKey: "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",
      });

      const chatbox = document.getElementById("chatbox");
      const messageForm = document.getElementById("message-form");

      // 在聊天框中添加用户输入和OpenAI的回答
      function addMessage(message, isUser) {
        const messageWrapper = document.createElement("div");
        const messageText = document.createElement("span");
        messageText.innerText = message;
        messageWrapper.appendChild(messageText);
        messageWrapper.classList.add(isUser ? "user" : "bot");
        chatbox.appendChild(messageWrapper);
      }

      // 发送用户输入到OpenAI API，并将回答添加到聊天框中
      function sendMessage(event) {
        event.preventDefault();
        const input = event.target.elements.message.value;
        if (input) {
          addMessage(input, true);
          event.target.elements.message.value = "";
          api.complete({
            engine: "davinci",
            prompt: input,
            maxTokens: 100,
            n: 1,
            stop: "\n",
            temperature: 0.7,
          })
            .then((response) => {
              const text = response.choices[0].text.trim();
              addMessage(text, false);
            })
            .catch((error) => console.error(error));
        }
      }

      // 绑定事件处理程序
      messageForm.addEventListener("submit", sendMessage);
    </script>
  </body>
</html>
